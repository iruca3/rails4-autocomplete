!function(t){t.fn.railsAutocomplete=function(){var e=function(){this.railsAutoCompleter||(this.railsAutoCompleter=new t.railsAutocomplete(this))};return void 0!==t.fn.on?$(document).on("focus",this.selector,e):this.live("focus",e)},t.railsAutocomplete=function(t){_e=t,this.init(_e)},t.railsAutocomplete.options={showNoMatches:"true",noMatchesLabel:"no existing match",minLength:2},t.railsAutocomplete.fn=t.railsAutocomplete.prototype={railsAutocomplete:"0.0.1"},t.railsAutocomplete.fn.extend=t.railsAutocomplete.extend=t.extend,t.railsAutocomplete.fn.extend({init:function(e){function i(t){return t.split(e.delimiter)}function a(t){return i(t).pop().replace(/^\s+/,"")}e.delimiter=t(e).attr("data-delimiter")||null,t(e).autocomplete({source:function(i,n){t.getJSON(t(e).attr("data-autocomplete"),{term:a(i.term)},function(){var i={};t.extend(i,t.railsAutocomplete.options),t.each(i,function(a,n){if(i.hasOwnProperty(a)){var o=t(e).attr("data-"+a);i[a]=o?o:n}}),0==arguments[0].length&&"true"==i.showNoMatches&&(arguments[0]=[],arguments[0][0]={id:"",label:i.noMatchesLabel}),t(arguments[0]).each(function(i,a){var n={};n[a.id]=a,t(e).data(n)}),n.apply(null,arguments)})},change:function(e,i){if(""!=t(t(this).attr("data-id-element")).val()){t(t(this).attr("data-id-element")).val(i.item?i.item.id:"");var a=t.parseJSON(t(this).attr("data-update-elements")),n=i.item?t(this).data(i.item.id.toString()):{};if(!a||""!=t(a.id).val())for(var o in a)t(a[o]).val(i.item?n[o]:"")}},search:function(){var i=a(this.value),n={};return t.extend(n,t.railsAutocomplete.options),t.each(n,function(i,a){if(n.hasOwnProperty(i)){var o=t(e).attr("data-"+i);n[i]=o?o:a}}),i.length<n.minLength?!1:void 0},focus:function(){return!1},select:function(a,n){var o=i(this.value);if(o.pop(),o.push(n.item.value),null!=e.delimiter)o.push(""),this.value=o.join(e.delimiter);else if(this.value=o.join(""),t(this).attr("data-id-element")&&t(t(this).attr("data-id-element")).val(n.item.id),t(this).attr("data-update-elements")){var r=t(this).data(n.item.id.toString()),l=t.parseJSON(t(this).attr("data-update-elements"));for(var s in l)t(l[s]).val(r[s])}var u=this.value;return t(this).bind("keyup.clearId",function(){t(this).val().trim()!=u.trim()&&(t(t(this).attr("data-id-element")).val(""),t(this).unbind("keyup.clearId"))}),t(e).trigger("railsAutocomplete.select",n),!1}})}}),t(document).ready(function(){t("input[data-autocomplete]").railsAutocomplete()})}(jQuery);
